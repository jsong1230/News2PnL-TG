# TODO 리스트

이 문서는 News2PnL-TG 프로젝트의 개선 사항과 작업 목록을 관리합니다.

## 📋 진행 현황

- **완료**: 10개
- **대기**: 5개
- **진행 중**: 0개
- **총**: 15개

---

## ✅ 완료된 항목

### 1. 재무 데이터 연동
- **상태**: 완료
- **설명**: PER, 부채비율, 3년 성장률 등 실제 재무 지표를 가져와서 LLM 체크리스트 점수에 반영 (현재는 가정치 0~2점 사용)
- **구현 파일**: `src/market/financial.py`, `src/analysis/stock_picker.py`
- **완료일**: 2025-12-30

### 2. Overnight Signals 개선
- **상태**: 완료
- **설명**: 더 많은 선행 지표 추가 (VIX, 원유, 금 등), 섹터별 선행 지표 매핑 강화
- **구현 파일**: `src/market/overnight.py`, `src/analysis/news_analyzer.py`
- **완료일**: 2025-12-30

### 3. Late-news penalty 튜닝
- **상태**: 완료
- **설명**: 선행 지표 기반 late-news 판단 로직 개선, 섹터별 임계값 조정
- **구현 파일**: `src/analysis/news_analyzer.py`
- **완료일**: 2025-12-30

### 4. 관찰 리스트 종목 다양성 개선
- **상태**: 완료
- **설명**: 항상 같은 종목만 선택되는 문제 해결, 뉴스 기반 종목 추출 강화
- **구현 파일**: `src/analysis/stock_picker.py`
- **완료일**: 2025-12-30

### 5. 테스트 커버리지 확대
- **상태**: 완료
- **설명**: news_analyzer, stock_picker, overnight_signals 등 핵심 모듈에 대한 단위 테스트 추가
- **구현 파일**: `tests/conftest.py`, `tests/test_news_analyzer.py`, `tests/test_stock_picker.py`, `tests/test_overnight.py`
- **완료일**: 2025-12-30
- **테스트 결과**: 58개 테스트 모두 통과 (news_analyzer: 30개, stock_picker: 16개, overnight: 11개, pnl: 1개)

### 6. 에러 핸들링 개선
- **상태**: 완료
- **설명**: Yahoo Finance API 실패 시 더 나은 fallback 로직, 네트워크 오류 시 exponential backoff 적용
- **구현 파일**: `src/utils/retry.py`, `src/market/provider.py`, `src/market/financial.py`, `tests/test_retry.py`
- **완료일**: 2025-12-30
- **주요 개선사항**:
  - Exponential backoff 데코레이터 구현 (최대 3회 재시도)
  - 에러 타입별 분류 (network, timeout, data, import, unknown)
  - 재시도 가능/불가능 에러 구분
  - 상세한 에러 로깅 및 추적
  - 15개 테스트 추가 (전체 73개 테스트 통과)

### 7. 뉴스 수집 품질 개선 (Phase 1)
- **상태**: 완료
- **설명**: 뉴스 품질 평가 시스템 도입 및 수집 단계 중복 필터링 강화
- **구현 파일**: `src/news/quality.py`, `src/utils/text.py`, `src/news/provider.py`, `tests/test_news_quality.py`
- **완료일**: 2025-12-30
- **주요 개선사항**:
  - 뉴스 품질 점수화 (제목 품질, 출처 신뢰도, 시간 유무)
  - 출처별 신뢰도 가중치 부여 (연합뉴스, 한국경제 등 주요 언론 가점)
  - 수집 단계에서 제목 유사도 기반 중복 제거 (Jaccard similarity)
  - 8개 단위 테스트 추가 (전체 81개 테스트 통과)

### 8. 뉴스 수집 품질 개선 (Phase 2)
- **상태**: 완료
- **설명**: 네이버 뉴스 API 통합 및 멀티 소스 수집 시스템 구축
- **구현 파일**: `src/news/provider.py`, `src/config.py`, `tests/test_naver_provider.py`
- **완료일**: 2025-12-30
- **주요 개선사항**:
  - `NaverNewsProvider` 구현 (네이버 오픈 API 연동)
  - `MultiNewsProvider` 구현 (여러 소스 동시 수집 및 통합 중복 제거)
  - `NEWS_PROVIDER` 설정을 통해 "rss,naver"와 같이 소스 조합 가능
  - 전체 테스트 86개 통과 확인

### 9. 리포트 품질 개선 (Phase 3-1)
- **상태**: 완료
- **설명**: LLM 프롬프트 최적화 및 분석 논리 고도화
- **구현 파일**: `src/analysis/stock_picker.py`, `src/market/financial.py`
- **완료일**: 2025-12-30
- **주요 개선사항**:
  - LLM 시스템/사용자 프롬프트 전면 개편 (Thesis/Catalyst 논리 강화)
  - 재무 데이터 기반 체크리스트 점수 산출 기준 강화 (엄격한 PER/부채비율 적용)
  - 섹터 특화 리스크 및 트리거 생성 유도

### 10. 시세 데이터 및 분석 고도화 (Phase 3-2)
- **상태**: 완료
- **설명**: 종목 마스터 확장 및 시세 지연 투명성 확보
- **구현 파일**: `src/data/kr_symbols.py`, `src/market/provider.py`, `tests/test_phase3_expansion.py`
- **완료일**: 2025-12-30
- **주요 개선사항**:
  - 한국 종목 마스터 20+개 주도주 추가 및 해외-국내 수혜주 매핑 대폭 확장
  - Yahoo Finance 시세 지연 시 로그 경고 로직 추가
  - 3개 신규 검증 테스트 추가 (전체 89개 테스트 통과)

---

## 🔄 진행 중인 항목

현재 진행 중인 항목이 없습니다.

---

## ⏳ 대기 중인 항목

### 4. 시세 데이터 정확도 개선
- **상태**: 대기
- **설명**: Yahoo Finance 외 추가 시세 제공자 지원 (예: 한국투자증권 API, DART API), 시세 지연 문제 해결
- **우선순위**: 중간
- **예상 작업**:
  - 한국투자증권 API 연동
  - DART API 연동
  - 시세 지연 문제 해결 로직 구현

### 5. LLM 비용 최적화
- **상태**: 대기
- **설명**: 프롬프트 최적화로 토큰 사용량 감소, 캐싱 전략 도입, 일일 예산 모니터링 강화
- **우선순위**: 중간
- **예상 작업**:
  - 프롬프트 최적화 (불필요한 정보 제거)
  - 캐싱 전략 구현 (같은 후보에 대한 반복 호출 방지)
  - 일일 예산 모니터링 대시보드 추가

### 6. 리포트 섹터 요약 및 거시 분석 고도화
- **상태**: 대기
- **설명**: 섹터별 뉴스 요약 정확도 개선, 거시 요약 자동화 강화
- **우선순위**: 중간
- **예상 작업**:
  - 섹터별 뉴스 요약 로직 개선
  - 거시 요약 자동화 로직 구현

### 7. 성능 최적화
- **상태**: 대기
- **설명**: 뉴스 수집 병렬화, DB 쿼리 최적화, 캐싱 전략 도입으로 GitHub Actions 실행 시간 단축
- **우선순위**: 낮음
- **예상 작업**:
  - 뉴스 수집 병렬화 (asyncio 또는 threading)
  - DB 쿼리 최적화 (인덱스 추가, 쿼리 최적화)
  - 캐싱 전략 구현 (Redis 또는 메모리 캐시)

### 8. 모니터링 및 로깅 개선
- **상태**: 대기
- **설명**: 구조화된 로깅, 에러 추적 강화, 성능 메트릭 수집 (실행 시간, API 호출 횟수 등)
- **우선순위**: 중간
- **예상 작업**:
  - 구조화된 로깅 (JSON 형식)
  - 에러 추적 시스템 연동 (Sentry 등)
  - 성능 메트릭 수집 및 대시보드

### 9. DB 최적화
- **상태**: 대기
- **설명**: SQLite DB 파일 크기 모니터링, 오래된 데이터 아카이빙, 인덱스 최적화
- **우선순위**: 낮음
- **예상 작업**:
  - DB 파일 크기 모니터링 스크립트
  - 오래된 데이터 아카이빙 로직
  - 인덱스 최적화

### 10. 문서화 개선
- **상태**: 대기
- **설명**: API 문서화, 아키텍처 다이어그램 추가, 개발자 온보딩 가이드 작성
- **우선순위**: 낮음
- **예상 작업**:
  - API 문서화 (Sphinx 또는 MkDocs)
  - 아키텍처 다이어그램 (Mermaid 또는 PlantUML)
  - 개발자 온보딩 가이드 작성

### 11. 검증 스크립트 개선
- **상태**: 대기
- **설명**: validate_before_commit.py에 더 많은 검증 항목 추가 (타입 체크, 린터 실행 등)
- **우선순위**: 낮음
- **예상 작업**:
  - 타입 체크 (mypy)
  - 린터 실행 (pylint 또는 flake8)
  - 코드 포맷팅 검증 (black)

### 12. 섹터 매핑 개선
- **상태**: 대기
- **설명**: 섹터 키워드 확장, 외국 종목과 한국 종목 간 연관성 매핑 강화 (FOREIGN_TO_KR_MAPPING 확장)
- **우선순위**: 낮음
- **예상 작업**:
  - 섹터 키워드 확장 (`src/analysis/sector_keywords.py`)
  - FOREIGN_TO_KR_MAPPING 확장 (`src/data/kr_symbols.py`)
  - 섹터별 종목 매핑 강화

---

## 📝 참고 사항

- 이 문서는 프로젝트의 개선 사항을 추적하기 위한 것입니다.
- 각 항목의 우선순위는 프로젝트의 현재 상태와 요구사항에 따라 변경될 수 있습니다.
- 완료된 항목은 구현 파일과 완료일을 기록하여 추적 가능하도록 합니다.

---

**마지막 업데이트**: 2025-12-30

